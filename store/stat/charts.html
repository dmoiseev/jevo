<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
		google.charts.load('current', {packages: ['corechart', 'line']});
		google.charts.setOnLoadCallback(drawCharts);
		/**
		 * Returns array of two items - min and max values. [min, max].
		 * Should be applied only to Numbers.
		 * @param {Array} arr Array of numbers, we are working with
		 * @return {Array} Array of two numbers - min and max values
		 */
		function getMinMax(arr) {
			return [Math.min(...arr), Math.max(...arr)];
		}
		/**
		 * Changes array values according to minimum and maximum values
		 * in etalon array.
		 * @param {Array} minMax Minimum and maximum values from etalon array
		 * @param {Array} arr Array we need to reformat according to minMax values.
		 * @return {Array} Reformated array
		 */
		function reformatArray(minMax, arr){
			var arrMinMax = getMinMax(arr); 
			var coef      = (minMax[1] - minMax[0]) / (arrMinMax[1] - arrMinMax[0]);
			
			return arr.map(function (el) {
				return (el - arrMinMax[0]) * coef + minMax[0];
			});
		}
		/**
		 * Creates as many charts data as many arguments we pass in
		 * @param {Boolean} trends Show trends only (original values will be changed).
		 * false - original values will be showed.
		 * @param {Array} indexArr X coordinate data array
		 * @param {Array} etalonArr Charts data arrays. First argument should be
		 * with maximum values comparing with others.
		 */
		function createCharts(trends, indexArr, etalonArr) {
			var data         = Array.prototype.slice.call(arguments);
			var result       = [];
			var etalonMinMax = getMinMax(etalonArr);
			var minMax;
			var arr;
			var i;
			var j;
			
			data.shift(); // removes trends
			data.shift(); // removes indexArr
			for (i = 0; i < indexArr.length; i++) {
				//
				// Value from etalon array. We don't need to change it.
				//
				arr = [indexArr[i]];
				if (arr !== undefined) {
					for (j = 0; j < data.length; j++) {
						if (trends) {
							arr.push(reformatArray(etalonMinMax, [].concat(data[j]))[i]);
						} else {
							arr.push(data[j][i]);
						}
					}
					result.push(arr);
				}
			}
			return result;
		}
		/**
		 * Prepares data for drawing. dataArr is an array of field names like
		 * 'Population', 'Energy' and so on... It's important, that first two
		 * items of this array should be:
		 * 0 - name of X coordinate
		 * 1 - etalon array
		 * 2... - other data arrays
		 * @param {Boolean} trends true if we want to show a trend charts
		 * @param {DataTable} dataTable google charts DataTable object
		 * @param {Object} population One population objects with all the fields
		 * @param {Array} dataArr Array of field names, which should be in chart
		 */
		function initData(trends, dataTable, population, dataArr) {
			var i;
			var chartsArr = [trends, population[dataArr[1]]];
			
			dataTable.addColumn('number', dataArr[0]);
			for (i = 2; i < dataArr.length; i++) {
				dataTable.addColumn('number', dataArr[i]);
				chartsArr.push(population[dataArr[i]]);
			}
			
			dataTable.addRows(createCharts.apply(null, chartsArr));
		}
		/**
		 * Draws charts one by one according to data...
		 */
		function drawCharts() {
			var data = new google.visualization.DataTable();
			
			var populations = [{
				// Organisms
				'Probabilities'          : [[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1],[100,300,95,0,1,1,1]],
				'Amount of functions'    : [5,     7,     7,      6,      6,     5,      6,      6,      6,      7,      6,       6,       6,      6,      6,      6,       6,       6,       ],
				'Functions calls'        : [5,     5,     4,      6,      7,     8,      6,      6,      6,      8,      11,      11,      11,     11,     12,     12,      12,      12,      ],
				'Mutations on clone'     : [21,    21,    8,      27,     4,     10,     7,      7,      7,      7,      7,       0,       0,      0,      0,      0,       0,       0,       ],
				'Mutations period'       : [3276,  5086,  9191,   6924,   9210,  5269,   9210,   9210,   9210,   9210,   9210,    9210,    9210,   9210,   9210,   9210,    9210,    9210,    ],
				'Mutations amount'       : [5,     41,    16,     35,     70,    0,      51,     51,     51,     7,      1,       6,       6,      6,      6,      6,       6,       6,       ],
				'Energy'                 : [772349,941580,1493407,1173252,211744,1537091,2205868,2682491,6614198,2749709,4307350, 3988756, 5083558,4763380,4947236,16583859,15063005,9313342, ],
				'Amount of lines'        : [141,   141,   148,    149,    143,   136,    143,    138,    142,    132,    138,     140,     145,    145,    152,    151,     152,     151,     ],
				// Population
				'Amount of organisms'    : [240,   154,   255,    264,    86,    256,    499,    500,    500,    488,    500,     498,     500,    496,    496,    500,     500,     500,     ],
				'IPS'                    : [6,     14,    6,      4,      18,    5,      3,      3,      2,      3,      3,       2,       2,      2,      1,      1,       1,       1,       ],
				'Generation number'      : [182664,194194,207040, 214598, 251679,263857, 270535, 272273, 277160, 282982, 288172,  293660,  303121, 306304, 312713, 319710,  320842,  322013,  ],
				// World
				'Name'                   : '00-nb',
				'Width\Height'           : [[400,300]],
				'Energy decrease period' : [20       ],
				'Energy decrease amount' : [1        ],
				'Remove after time'      : [2000     ],
				'Remove amount'          : [50       ],
				'Clone period'           : [5        ],
				'Max arganisms amount'   : [500      ],
				'Energy check period'    : [5000     ]
			}]
			//
			// First two arguments are: X coordinate array and etalon array
			//
			initData(true, data, populations[0], ['Population age', 'Generation number', 'Amount of functions', 'Functions calls', 'Mutations amount', 'Amount of lines']);
			//
			// Charts related options
			//
			var options = {
				hAxis: {
					title: 'Population age'
				},
				/*vAxis: {
					title: 'Amount'
				},*/
				lineWidth: 3,
				curveType: 'function',
				pointsVisible: true
			};
			//
			// Draw charts in DOM
			//
			var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
			chart.draw(data, options);
		}
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 1250px; height: 700px"></div>
  </body>
</html>